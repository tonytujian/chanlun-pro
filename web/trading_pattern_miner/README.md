# 股票交易规律挖掘系统

一个基于React + TypeScript的智能股票交易规律挖掘系统，集成了自动策略生成、形态匹配、回测分析和参数优化等核心功能。

## 🚀 核心功能

### 1. 数据导入与预处理
- **多格式支持**：CSV、TXT等格式的股票数据导入
- **智能列映射**：自动识别日期、开盘价、收盘价等字段
- **数据验证**：实时验证数据完整性和合理性
- **技术指标计算**：自动计算MA、RSI、MACD、布林带等常用指标

### 2. 自动策略生成
- **遗传算法**：使用遗传算法自动进化交易策略
- **多指标组合**：支持多种技术指标的条件组合
- **适应度评估**：基于收益率、胜率、夏普比率等多维度评估
- **策略优化**：通过选择、交叉、变异操作持续优化策略

### 3. 形态匹配分析
- **DTW算法**：动态时间规整算法识别相似价格形态
- **特征提取**：提取波动率、趋势、成交量等关键特征
- **相似度计算**：综合价格和成交量的相似度评分
- **历史回溯**：查找历史上相似形态的后续走势

### 4. 策略回测系统
- **真实环境模拟**：考虑交易成本、滑点等实际因素
- **多种离场策略**：支持止损、止盈、时间止损等
- **详细报告**：生成完整的回测报告和交易记录
- **可视化分析**：资金曲线、回撤分析等图表展示

### 5. 参数优化
- **网格搜索**：遍历参数空间寻找最优组合
- **贝叶斯优化**：智能搜索算法提高优化效率
- **敏感性分析**：分析参数变化对策略表现的影响
- **过拟合防护**：Walk-Forward优化避免过拟合

## 🛠 技术架构

### 前端技术栈
- **React 18**：现代化React框架
- **TypeScript**：类型安全的JavaScript超集
- **Ant Design 5**：企业级UI组件库
- **ECharts**：专业的数据可视化图表库
- **Web Workers**：多线程计算避免UI阻塞

### 核心算法
- **遗传算法**：策略自动生成和优化
- **DTW算法**：时间序列形态匹配
- **技术指标**：完整的技术分析指标库
- **回测引擎**：高性能的策略回测系统

### 性能优化
- **虚拟滚动**：处理大数据量表格和列表
- **Web Workers**：密集计算任务后台处理
- **数据缓存**：智能缓存机制提升响应速度
- **懒加载**：按需加载组件和数据

## 📦 安装和启动

### 环境要求
- Node.js >= 16.0.0
- npm >= 8.0.0 或 yarn >= 1.22.0

### 快速开始

```bash
# 克隆项目
git clone <repository-url>
cd trading-pattern-miner

# 安装依赖
npm install

# 启动开发服务器
npm start
```

服务器将在 http://localhost:3000 启动

### 构建生产版本

```bash
# 构建生产版本
npm run build

# 预览构建结果
npm run preview
```

## 📊 使用指南

### 1. 数据导入
1. 准备CSV格式的股票历史数据
2. 在"数据导入"页面上传文件
3. 配置列映射（系统会自动识别）
4. 等待数据处理和技术指标计算完成

### 2. 策略生成
1. 进入"策略生成"页面
2. 设置遗传算法参数（种群大小、进化代数等）
3. 点击"开始生成"等待策略进化完成
4. 查看生成的策略并保存优秀策略

### 3. 形态匹配
1. 在"形态匹配"页面选择目标价格形态
2. 设置匹配参数（相似度阈值、最大匹配数等）
3. 启动匹配算法搜索相似历史形态
4. 分析匹配结果和形态特征

### 4. 策略回测
1. 在"策略回测"页面选择要测试的策略
2. 配置回测参数（初始资金、手续费等）
3. 运行回测获得详细的性能报告
4. 分析资金曲线、交易记录等结果

### 5. 参数优化
1. 选择需要优化的策略和参数范围
2. 选择优化算法（网格搜索或贝叶斯优化）
3. 启动优化过程寻找最佳参数组合
4. 查看优化结果和参数敏感性分析

## 📁 项目结构

```
src/
├── components/          # 可复用组件
│   ├── TradingChart.tsx        # 交易图表组件
│   ├── PerformanceMonitor.tsx  # 性能监控组件
│   ├── ResponsiveLayout.tsx    # 响应式布局
│   └── VirtualTable.tsx        # 虚拟滚动表格
├── pages/              # 页面组件
│   ├── DataImportPage.tsx      # 数据导入页面
│   ├── ChartAnalysisPage.tsx   # 图表分析页面
│   ├── StrategyGeneratorPage.tsx # 策略生成页面
│   ├── PatternMatchingPage.tsx # 形态匹配页面
│   ├── BacktestPage.tsx        # 策略回测页面
│   └── OptimizationPage.tsx    # 参数优化页面
├── utils/              # 工具类
│   └── WorkerManager.ts        # Web Worker管理器
├── types/              # TypeScript类型定义
│   └── index.ts               # 核心类型定义
├── App.tsx             # 主应用组件
└── index.tsx           # 应用入口
```

## 🔧 配置说明

### 环境变量
创建 `.env` 文件配置环境变量：

```env
# API服务器地址
REACT_APP_API_URL=http://localhost:8080

# 是否启用性能监控
REACT_APP_ENABLE_PERFORMANCE_MONITOR=true

# 默认图表主题
REACT_APP_CHART_THEME=light
```

### 自定义配置
在 `src/config/` 目录下可以自定义各种配置：

- `indicators.ts` - 技术指标配置
- `strategies.ts` - 策略模板配置
- `optimization.ts` - 优化算法配置

## 🎯 核心算法详解

### 遗传算法策略生成
1. **初始化种群**：随机生成初始策略种群
2. **适应度评估**：使用历史数据评估每个策略的表现
3. **选择操作**：选择表现优秀的策略进行繁殖
4. **交叉操作**：组合优秀策略的特征产生新策略
5. **变异操作**：随机改变策略参数增加多样性
6. **迭代进化**：重复上述过程直到收敛

### DTW形态匹配算法
1. **特征提取**：从价格序列中提取关键特征
2. **距离计算**：使用DTW算法计算序列间距离
3. **相似度评分**：综合价格和成交量相似度
4. **结果排序**：按相似度降序返回匹配结果

### 回测引擎设计
1. **信号生成**：根据策略条件生成买卖信号
2. **订单执行**：模拟真实交易环境执行订单
3. **风险控制**：实施止损、止盈等风险管理
4. **绩效计算**：计算收益率、夏普比率等指标

## 🚀 性能优化

### Web Workers优化
- 技术指标计算在独立线程中进行
- 策略生成和回测使用后台计算
- 形态匹配算法异步执行
- 参数优化并行处理

### 内存管理
- 大数据集分批处理
- 及时清理不需要的计算结果
- 使用虚拟滚动处理大列表
- 智能缓存策略减少重复计算

### 响应式设计
- 移动端适配优化
- 触摸操作友好
- 自适应布局设计
- 性能监控和预警

## 🤝 贡献指南

欢迎提交Issue和Pull Request来改进项目！

### 开发流程
1. Fork项目到个人仓库
2. 创建功能分支：`git checkout -b feature/new-feature`
3. 提交更改：`git commit -am 'Add new feature'`
4. 推送分支：`git push origin feature/new-feature`
5. 创建Pull Request

### 代码规范
- 使用TypeScript进行类型检查
- 遵循ESLint和Prettier配置
- 编写单元测试覆盖核心功能
- 添加详细的代码注释

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情

## 🙏 致谢

感谢以下开源项目的支持：
- [React](https://reactjs.org/) - 用户界面库
- [Ant Design](https://ant.design/) - 企业级UI设计语言
- [ECharts](https://echarts.apache.org/) - 数据可视化图表库
- [TypeScript](https://www.typescriptlang.org/) - JavaScript的超集

---

如有问题或建议，请提交Issue或联系开发团队。
